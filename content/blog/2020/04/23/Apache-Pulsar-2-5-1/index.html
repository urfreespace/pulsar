<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed"><title data-react-helmet="true">Apache Pulsar 2.5.1 | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/blog/2020/04/23/Apache-Pulsar-2-5-1"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Apache Pulsar 2.5.1 | Apache Pulsar"><meta data-react-helmet="true" name="description" content="We are proud to publish Apache Pulsar 2.5.1. This is the result of a huge effort from the community, with over 130 commits and a long list of new features, general improvements and bug fixes."><meta data-react-helmet="true" property="og:description" content="We are proud to publish Apache Pulsar 2.5.1. This is the result of a huge effort from the community, with over 130 commits and a long list of new features, general improvements and bug fixes."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2020-04-23T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://twitter.com/tuteng3"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/blog/2020/04/23/Apache-Pulsar-2-5-1"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/blog/2020/04/23/Apache-Pulsar-2-5-1" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/blog/2020/04/23/Apache-Pulsar-2-5-1" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7e3a3d28.css">
<link rel="preload" href="/assets/js/runtime~main.64567627.js" as="script">
<link rel="preload" href="/assets/js/main.7befe8d6.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="tailwind navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a class="font-bold underline mr-4 -ml-4" href="/versions/">2.9.1</a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link" href="/docs/client-libraries">Clients</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">REST APIs</a><ul class="dropdown__menu"><li><a href="/admin-rest-api?version=2.9.1&amp;apiversion=v2" rel="noopener noreferrer" class="dropdown__link"><span>Admin REST API</span></a></li><li><a href="/functions-rest-api?version=2.9.1&amp;apiversion=v3" rel="noopener noreferrer" class="dropdown__link"><span>Functions</span></a></li><li><a href="/source-rest-api?version=2.9.1&amp;apiversion=v3" rel="noopener noreferrer" class="dropdown__link"><span>Sources</span></a></li><li><a href="/sink-rest-api?version=2.9.1&amp;apiversion=v3" rel="noopener noreferrer" class="dropdown__link"><span>Sinks</span></a></li><li><a href="/packages-rest-api?version=2.9.1&amp;apiversion=v3" rel="noopener noreferrer" class="dropdown__link"><span>Packages</span></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">CLI</a><ul class="dropdown__menu"><li><a href="/pulsar-admin-cli?version=2.9.1" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Admin</span></a></li><li><a href="/pulsar-client-cli?version=2.9.1" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Client</span></a></li><li><a href="/pulsar-perf-cli?version=2.9.1" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Perf</span></a></li><li><a href="/pulsar-cli?version=2.9.1" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar</span></a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contact">Contact</a></li><li><a class="dropdown__link" href="/contributing">Contributing</a></li><li><a class="dropdown__link" href="/coding-guide">Coding guide</a></li><li><a class="dropdown__link" href="/events">Events</a></li><li><a href="https://twitter.com/Apache_Pulsar" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Twitter<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Wiki<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Issue tracking<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://pulsar-summit.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Pulsar Summit<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a class="dropdown__link" href="/resources">Resources</a></li><li><a class="dropdown__link" href="/team">Team</a></li><li><a class="dropdown__link" href="/powered-by">Powered By</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link">Apache</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Foundation<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>License<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Sponsorship<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Thanks<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Security<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_iQ2x toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/14/Apache-Pulsar-2-7-4">What’s New in Apache Pulsar 2.7.4</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/11/Log4j-CVE">Log4j2 Zero Day vulnerability (CVE-2021-44228)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/09/23/Apache-Pulsar-2-8-1">Apache Pulsar 2.8.1</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/08/18/asia-cfp">Announcing Pulsar Summit Asia 2021: CFP Is Open!</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/08/11/Apache-Pulsar-2-7-3">Apache Pulsar 2.7.3</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Apache Pulsar 2.5.1</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2020-04-23T00:00:00.000Z" itemprop="datePublished">April 23, 2020</time> · <!-- -->7 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/tuteng3" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Guangning E</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>We are proud to publish Apache Pulsar 2.5.1. This is the result of a huge effort from the community, with over 130 commits and a long list of new features, general improvements and bug fixes.</p><p>For detailed changes related to 2.5.1 release, refer to the <b><a href="/release-notes/#2.5.1">release notes</a></b> and the <b><a href="https://github.com/apache/pulsar/pulls?q=is:pr%20label:release/2.5.1%20is:closed" target="_blank" rel="noopener noreferrer">PR list for Pulsar 2.5.1</a></b>.</p><p>The following justs highlights a tiny subset of new features.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="refresh-authentication-credentials">Refresh authentication credentials<a class="hash-link" href="#refresh-authentication-credentials" title="Direct link to heading">​</a></h2><p>In Pulsar 2.5.1, two more methods are introduced in the single <code>AuthenticationState</code> interface credentials holder. This helps enhance the Pulsar authentication framework to support credentials that expire over time and need to be refreshed by forcing clients to re-authenticate.</p><p>Existing authentication plugins are unaffected. If a new plugin wants to support expiration, it just overrides the <code>isExpired()</code> method. The Pulsar broker ensures to periodically check the expiration status for the AuthenticationState of every <code>ServerCnx</code> object. You can also use the <code>authenticationRefreshCheckSeconds</code> setting to control the frequency of the expiration check.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="upgrade-avro-to-191">Upgrade Avro to 1.9.1<a class="hash-link" href="#upgrade-avro-to-191" title="Direct link to heading">​</a></h2><p>The library used to handle logical datetime values has been changed from Joda-Time to JSR-310. For keeping forward compatibility, Pulsar java client uses Joda-Time conversion for logical datetime. To use JSR-310 conversion, you can enable it in the schema definition.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AvroSchema.of(SchemaDefinition.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.withJSR310ConversionEnabled(true)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">.build()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>By default, Avro 1.9.1 enables the JSR310 datetimes, which might introduce some regression problems if users use source codes generated by Avro compiler 1.8.x and the source codes contain datetimes fields. It is recommended to use Avro 1.9.x compiler to recompile.</p></div></div><p>And, Avro may remove the Joda time support in the future. This may also be deleted in Pulsar in the future.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="support-unloading-all-partitions-of-a-partitioned-topic">Support unloading all partitions of a partitioned topic<a class="hash-link" href="#support-unloading-all-partitions-of-a-partitioned-topic" title="Direct link to heading">​</a></h2><p>Before Pulsar 2.5.1, Pulsar supports unloading a non-partitioned topic or a partition of a partitioned topic. If there is a partitioned topic with too many partitions, users need to get all partitions and unload them one by one. In Pulsar 2.5.1, we support unloading all partitions of a partitioned topic.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="supports-evenly-distributing-topics-count-when-splitting-bundle">Supports evenly distributing topics count when splitting bundle<a class="hash-link" href="#supports-evenly-distributing-topics-count-when-splitting-bundle" title="Direct link to heading">​</a></h2><p>In Pulsar 2.5.1, we introduce an option(<code>-balance-topic-count</code>) for bundle split. When setting this option to true, the given bundle is split into two parts and each part has the same amount of topics. In addition, we bring in a new Load Manager implementation named <code>org.apache.pulsar.broker.loadbalance.impl.BalanceTopicCountModularLoadManager</code>. The new Load Manager implementation splits the bundle with balance topics count.
You can enable this feature in the broker.conf:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">defaultNamespaceBundleSplitAlgorithm=topic_count_equally_divide</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you use the Pulsar Admin to split a bundle, you can use following command to split bundle based on topics count:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin/pulsar-admin namespaces split-bundle -b 0x00000000_0xffffffff --split-algorithm-name topic_count_equally_divide public/default</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="support-keyvalue-schema-for-pulsar-sql">Support KeyValue schema for Pulsar SQL<a class="hash-link" href="#support-keyvalue-schema-for-pulsar-sql" title="Direct link to heading">​</a></h2><p>Before Pulsar 2.5.1, Pulsar SQL cannot read the keyValue schema data. In Pulsar 2.5.1, we add the prefix <code>key.</code> for the key field name, add the prefix <code>value.</code> for the value field name. Therefore, Pulsar SQL can read the keyValue schema data.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="update-netty-version-to-4145final">Update Netty version to <code>4.1.45.Final</code><a class="hash-link" href="#update-netty-version-to-4145final" title="Direct link to heading">​</a></h2><p>Netty 4.1.43 has a bug, which prevents it from using Linux native Epoll transport. This makes Pulsar brokers fail over to NioEventLoopGroup even when running on Linux. The bug is fixed in Netty  <code>4.1.45.Final</code> .</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="improve-key_shared-subscription-message-dispatching-performance">Improve Key_Shared subscription message dispatching performance<a class="hash-link" href="#improve-key_shared-subscription-message-dispatching-performance" title="Direct link to heading">​</a></h2><p>In Pulsar 2.5.1, to improve Key_Shared subscription message dispatching performance, we make the following operations for saving CPU usage which can improve non-batched message dispatch performance:</p><ul><li>Reduce making hash for the message key.</li><li>Reduce the number of finding consumers for message keys..</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="add-joda-time-logical-type-conversion">Add Joda time logical type conversion<a class="hash-link" href="#add-joda-time-logical-type-conversion" title="Direct link to heading">​</a></h2><p>In Pulsar 2.5.1, Avro is upgraded to 1.9.x and the default time conversion is changed to JSR-310. For forwarding compatibility, we add the Joda time conversion in Pulsar 2.5.1 and enable it by default</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="support-deleting-inactive-topic-when-subscriptions-caught-up">Support deleting inactive topic when subscriptions caught up<a class="hash-link" href="#support-deleting-inactive-topic-when-subscriptions-caught-up" title="Direct link to heading">​</a></h2><p>Before Pulsar 2.5.1, Pulsar supported deleting inactive topics that have no active producers or subscriptions. In Pulsar 2.5.1, we expose inactive topic delete mode in <code>broker.conf</code> to delete inactive topics that have no active producers or consumers but all subscriptions of the topic are caught up. You can enable this feature in the broker.conf:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">brokerDeleteInactiveTopicsMode=delete_when_subscriptions_caught_up</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="introduce-maxmessagepublishbuffersizeinmb-configuration-to-avoid-broker-oom">Introduce maxMessagePublishBufferSizeInMB configuration to avoid broker OOM<a class="hash-link" href="#introduce-maxmessagepublishbuffersizeinmb-configuration-to-avoid-broker-oom" title="Direct link to heading">​</a></h2><p>Before Pulsar 2.5.1, if a broker has a smaller direct memory (e.g. 2G) and runs pulsar-perf to write messages, the broker becomes unstable. Because the broker reads messages from the channel automatically and the ByteBuf cannot be released until the entry is written to Bookie successfully or the timeout expires.
In Pulsar 2.5.1, we introduce the <code>maxMessagePublishBufferSizeInMB</code> configuration to avoid broker OOM (Out of Memory). If the processing message size exceeds this value, the broker stops reading data from the connection. When the available size is greater than half of the maxMessagePublishBufferSizeInMB,  the broker starts automatically reading data from the connection. You can set up the publish buffer size in broker.conf:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Max memory size for broker handling messages sending from producers.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># If the processing message size exceed this value, broker will stop read data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># from the connection. The processing messages means messages are sends to broker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># but broker have not send response to client, usually waiting to write to bookies.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># It&#x27;s shared across all the topics running in the same broker.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Use -1 to disable the memory limitation. Default is 1/2 of direct memory.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">maxMessagePublishBufferSizeInMB=</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="support-bouncycastle-fips-provider">Support BouncyCastle FIPS provider<a class="hash-link" href="#support-bouncycastle-fips-provider" title="Direct link to heading">​</a></h2><p>In Pulsar 2.5.1, Pulsar supports BC-FIPS (BouncyCastle FIPS) provider. Before Pulsar 2.5.1, Pulsar only supported BouncyCastle (BC) provider, and BC JARs are tied strongly into both the broker and the client code. Users fail to change from the BC provider to the BC-FIPS provider. This feature splits the BC dependency out into a separate module. Therefore, users can freely switch between the BC provider and the BC-FIPS provider.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="allow-tenant-admin-to-manage-subscription-permission">Allow tenant Admin to manage subscription permission<a class="hash-link" href="#allow-tenant-admin-to-manage-subscription-permission" title="Direct link to heading">​</a></h2><p>In previous releases, we have added support to grant subscriber-permission to manage subscription based APIs. However, grant-subscription-permission API requires super-user access and it creates too much dependency on system-admin when many tenants want to grant subscription permission.
In Pulsar 2.5.1, through the Restful API or the Pulsar Admin, we allow each tenant Admin to manage subscription permission in order to reduce administrative efforts for super users.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="allow-to-enabledisable-delayed-delivery-for-messages-on-namespace">Allow to enable/disable delayed delivery for messages on namespace<a class="hash-link" href="#allow-to-enabledisable-delayed-delivery-for-messages-on-namespace" title="Direct link to heading">​</a></h2><p>In Pulsar 2.5.1, we add the <code>set-delayed-delivery</code> and  <code>set-delayed-delivery-time</code>  policies for the namespace. Therefore, Pulsar 2.5.1 allows to enable or disable delayed delayed delivery for messages on namespace.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="support-offloader-at-namespace-level">Support offloader at namespace level<a class="hash-link" href="#support-offloader-at-namespace-level" title="Direct link to heading">​</a></h2><p>In previous releases, the offload operation only had the cluster-level configuration. Users cannot set the offload configuration at the namespace level. In Pulsar 2.5.1, we support using the Pulsar Admin to set the offloader at the namespace level. </p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="disallow-sub-auto-creation-by-admin-when-disabling-topic-auto-creation">Disallow sub auto creation by Admin when disabling topic auto creation<a class="hash-link" href="#disallow-sub-auto-creation-by-admin-when-disabling-topic-auto-creation" title="Direct link to heading">​</a></h2><p>In previous releases, when Auto topic creation is disabled in KoP, non-partitioned topics are created with Flink Pulsar Source. To fix this bug, in Pulsar 2.5.1, we change the admin code to disable sub auto creation by the Admin when Auto topic creation is disabled.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="support-python-38-for-pulsar-client">Support Python 3.8 for Pulsar client<a class="hash-link" href="#support-python-38-for-pulsar-client" title="Direct link to heading">​</a></h2><p>In pulsar 2.5.1, we add <code>3.8 cp38-cp38</code> to support Python 3.8 for the Pulsar client. Therefore, users can install the Pulsar client on Python 3.8 .</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="provide-another-libpulsarwithdepsa-in-debianrpm-cpp-client-library">Provide another <code>libpulsarwithdeps.a</code> in Debian/RPM cpp client library<a class="hash-link" href="#provide-another-libpulsarwithdepsa-in-debianrpm-cpp-client-library" title="Direct link to heading">​</a></h2><p>Pulsar 2.5.1 mainly provides 2 additional pulsar c++ client libraries in Debian/RPM:</p><ul><li>pulsarSharedNossl (libpulsarnossl.so): it is similar to pulsarShared(libpulsar.so), and has no SSL statically linked.</li><li>pulsarStaticWithDeps(libpulsarwithdeps.a): it is similar to pulsarStatic(libpulsar.a), and is archived in the dependencies libraries of <code>libboost_regex</code>, <code>libboost_system</code>, <code>libcurl</code>, <code>libprotobuf</code>, <code>libzstd</code> and <code>libz</code> statically.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="reference">Reference<a class="hash-link" href="#reference" title="Direct link to heading">​</a></h2><p>To download Apache Pulsar 2.5.1, click <a href="https://pulsar.apache.org/en/download/" target="_blank" rel="noopener noreferrer">here</a>.
If you have any questions or suggestions, contact us with mailing lists or slack.</p><ul><li><a href="mailto:users@pulsar.apache.org" target="_blank" rel="noopener noreferrer">users@pulsar.apache.org</a></li><li><a href="mailto:dev@pulsar.apache.org" target="_blank" rel="noopener noreferrer">dev@pulsar.apache.org</a></li><li>Pulsar slack channel: <a href="https://apache-pulsar.slack.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.slack.com/</a></li><li>Self-registration at <a href="https://apache-pulsar.herokuapp.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.herokuapp.com/</a>
Looking forward to your contributions to <a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer">Pulsar</a>.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2020/05/19/Apache-Pulsar-2-5-2"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« <!-- -->Apache Pulsar 2.5.2</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/03/17/announcing-the-apache-pulsar-2020-user-survey-report"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Announcing: The Apache Pulsar 2020 User Survey Report<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#refresh-authentication-credentials" class="table-of-contents__link toc-highlight">Refresh authentication credentials</a></li><li><a href="#upgrade-avro-to-191" class="table-of-contents__link toc-highlight">Upgrade Avro to 1.9.1</a></li><li><a href="#support-unloading-all-partitions-of-a-partitioned-topic" class="table-of-contents__link toc-highlight">Support unloading all partitions of a partitioned topic</a></li><li><a href="#supports-evenly-distributing-topics-count-when-splitting-bundle" class="table-of-contents__link toc-highlight">Supports evenly distributing topics count when splitting bundle</a></li><li><a href="#support-keyvalue-schema-for-pulsar-sql" class="table-of-contents__link toc-highlight">Support KeyValue schema for Pulsar SQL</a></li><li><a href="#update-netty-version-to-4145final" class="table-of-contents__link toc-highlight">Update Netty version to <code>4.1.45.Final</code></a></li><li><a href="#improve-key_shared-subscription-message-dispatching-performance" class="table-of-contents__link toc-highlight">Improve Key_Shared subscription message dispatching performance</a></li><li><a href="#add-joda-time-logical-type-conversion" class="table-of-contents__link toc-highlight">Add Joda time logical type conversion</a></li><li><a href="#support-deleting-inactive-topic-when-subscriptions-caught-up" class="table-of-contents__link toc-highlight">Support deleting inactive topic when subscriptions caught up</a></li><li><a href="#introduce-maxmessagepublishbuffersizeinmb-configuration-to-avoid-broker-oom" class="table-of-contents__link toc-highlight">Introduce maxMessagePublishBufferSizeInMB configuration to avoid broker OOM</a></li><li><a href="#support-bouncycastle-fips-provider" class="table-of-contents__link toc-highlight">Support BouncyCastle FIPS provider</a></li><li><a href="#allow-tenant-admin-to-manage-subscription-permission" class="table-of-contents__link toc-highlight">Allow tenant Admin to manage subscription permission</a></li><li><a href="#allow-to-enabledisable-delayed-delivery-for-messages-on-namespace" class="table-of-contents__link toc-highlight">Allow to enable/disable delayed delivery for messages on namespace</a></li><li><a href="#support-offloader-at-namespace-level" class="table-of-contents__link toc-highlight">Support offloader at namespace level</a></li><li><a href="#disallow-sub-auto-creation-by-admin-when-disabling-topic-auto-creation" class="table-of-contents__link toc-highlight">Disallow sub auto creation by Admin when disabling topic auto creation</a></li><li><a href="#support-python-38-for-pulsar-client" class="table-of-contents__link toc-highlight">Support Python 3.8 for Pulsar client</a></li><li><a href="#provide-another-libpulsarwithdepsa-in-debianrpm-cpp-client-library" class="table-of-contents__link toc-highlight">Provide another <code>libpulsarwithdeps.a</code> in Debian/RPM cpp client library</a></li><li><a href="#reference" class="table-of-contents__link toc-highlight">Reference</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright © 2021 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.64567627.js"></script>
<script src="/assets/js/main.7befe8d6.js"></script>
</body>
</html>