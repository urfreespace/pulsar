<!doctype html>
<html class="docs-version-2.4.0" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed"><title data-react-helmet="true">The Pulsar Functions API | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/docs/2.4.0/functions-api"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.4.0"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.4.0"><meta data-react-helmet="true" property="og:title" content="The Pulsar Functions API | Apache Pulsar"><meta data-react-helmet="true" name="description" content="Pulsar Functions provides an easy-to-use API that developers can use to create and manage processing logic for the Apache Pulsar messaging system. With Pulsar Functions, you can write functions of any level of complexity in Java or Python and run them in conjunction with a Pulsar cluster without needing to run a separate stream processing engine."><meta data-react-helmet="true" property="og:description" content="Pulsar Functions provides an easy-to-use API that developers can use to create and manage processing logic for the Apache Pulsar messaging system. With Pulsar Functions, you can write functions of any level of complexity in Java or Python and run them in conjunction with a Pulsar cluster without needing to run a separate stream processing engine."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/docs/2.4.0/functions-api"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.4.0/functions-api" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.4.0/functions-api" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f75c5a00.css">
<link rel="preload" href="/assets/js/runtime~main.f92a773e.js" as="script">
<link rel="preload" href="/assets/js/main.343abb0d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.4.0/">Docs</a><a class="navbar__item navbar__link" href="/versions">Versions</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/docs">Version</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/">2.8.0</a></li><li><a class="dropdown__link" href="/docs/2.7.3/">2.7.3</a></li><li><a class="dropdown__link" href="/docs/2.7.2/">2.7.2</a></li><li><a class="dropdown__link" href="/docs/2.7.1/">2.7.1</a></li><li><a class="dropdown__link" href="/docs/2.7.0/">2.7.0</a></li><li><a class="dropdown__link" href="/docs/2.6.4/">2.6.4</a></li><li><a class="dropdown__link" href="/docs/2.6.3/">2.6.3</a></li><li><a class="dropdown__link" href="/docs/2.6.2/">2.6.2</a></li><li><a class="dropdown__link" href="/docs/2.6.1/">2.6.1</a></li><li><a class="dropdown__link" href="/docs/2.6.0/">2.6.0</a></li><li><a class="dropdown__link" href="/docs/2.5.2/">2.5.2</a></li><li><a class="dropdown__link" href="/docs/2.5.1/">2.5.1</a></li><li><a class="dropdown__link" href="/docs/2.5.0/">2.5.0</a></li><li><a class="dropdown__link" href="/docs/2.4.2/">2.4.2</a></li><li><a class="dropdown__link" href="/docs/2.4.1/">2.4.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/2.4.0/">2.4.0</a></li><li><a class="dropdown__link" href="/docs/2.2.0/">2.2.0</a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Get Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts and Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Pulsar Functions</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-quickstart">Get started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/2.4.0/functions-api">API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-deploying">Deploying functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-guarantees">Processing guarantees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-state">State Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-metrics">Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-worker">Admin: Pulsar Functions Worker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-runtime">Admin: Configure Functions runtime</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/functions-debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.0/window-functions-context">Window Functions: Context</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar IO</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar SQL</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Administration</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Client Libraries</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Admin API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Adaptors</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cookbooks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Pulsar<!-- --> <b>2.4.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/">latest version</a></b> (<!-- -->2.8.0<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2.4.0</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>The Pulsar Functions API</h1></header><p><a href="/docs/2.4.0/functions-overview">Pulsar Functions</a> provides an easy-to-use API that developers can use to create and manage processing logic for the Apache Pulsar messaging system. With Pulsar Functions, you can write functions of any level of complexity in <a href="#functions-for-java">Java</a> or <a href="#functions-for-python">Python</a> and run them in conjunction with a Pulsar cluster without needing to run a separate stream processing engine.</p><blockquote><p>For a more in-depth overview of the Pulsar Functions feature, see the <a href="/docs/2.4.0/functions-overview">Pulsar Functions overview</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="core-programming-model">Core programming model<a aria-hidden="true" class="hash-link" href="#core-programming-model" title="Direct link to heading">â€‹</a></h2><p>Pulsar Functions provide a wide range of functionality but are based on a very simple programming model. You can think of Pulsar Functions as lightweight processes that</p><ul><li>consume messages from one or more Pulsar topics and then</li><li>apply some user-defined processing logic to each incoming message. That processing logic could be just about anything you want, including<ul><li>producing the resulting, processed message on another Pulsar topic, or</li><li>doing something else with the message, such as writing results to an external database.</li></ul></li></ul><p>You could use Pulsar Functions, for example, to set up the following processing chain:</p><ul><li>A <a href="#functions-for-python">Python</a> function listens on the <code>raw-sentences</code> topic and &quot;<a href="#example-function">sanitizes</a>&quot; incoming strings (removing extraneous whitespace and converting all characters to lower case) and then publishes the results to a <code>sanitized-sentences</code> topic</li><li>A <a href="#functions-for-java">Java</a> function listens on the <code>sanitized-sentences</code> topic, counts the number of times each word appears within a specified time window, and publishes the results to a <code>results</code> topic</li><li>Finally, a Python function listens on the <code>results</code> topic and writes the results to a MySQL table</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="example-function">Example function<a aria-hidden="true" class="hash-link" href="#example-function" title="Direct link to heading">â€‹</a></h3><p>Here&#x27;s an example &quot;input sanitizer&quot; function written in Python and stored in a <code>sanitizer.py</code> file:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">clean_string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">s</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">strip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">lower</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> clean_string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Some things to note about this Pulsar Function:</p><ul><li>There is no client, producer, or consumer object involved. All message &quot;plumbing&quot; is already taken care of for you, enabling you to worry only about processing logic.</li><li>No topics, subscription types, tenants, or namespaces are specified in the function logic itself. Instead, topics are specified upon <a href="#example-deployment">deployment</a>. This means that you can use and re-use Pulsar Functions across topics, tenants, and namespaces without needing to hard-code those attributes.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="example-deployment">Example deployment<a aria-hidden="true" class="hash-link" href="#example-deployment" title="Direct link to heading">â€‹</a></h3><p>Deploying Pulsar Functions is handled by the <a href="/docs/2.4.0/reference-pulsar-admin"><code>pulsar-admin</code></a> CLI tool, in particular the <a href="/docs/2.4.0/pulsar-admin#functions"><code>functions</code></a> command. Here&#x27;s an example command that would run our <a href="#example-function">sanitizer</a> function from above in <a href="/docs/2.4.0/functions-deploying#local-run-mode">local run</a> mode:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions localrun </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --py sanitizer.py </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)"># The Python file with the function&#x27;s code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --classname sanitizer </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># The class or function holding the processing logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --tenant public </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">            </span><span class="token comment" style="color:rgb(98, 114, 164)"># The function&#x27;s tenant (derived from the topic name by default)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --namespace default </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># The function&#x27;s namespace (derived from the topic name by default)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --name sanitizer-function </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The name of the function (the class name by default)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --inputs dirty-strings-in </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># The input topic(s) for the function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --output clean-strings-out </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)"># The output topic for the function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --log-topic sanitizer-logs   </span><span class="token comment" style="color:rgb(98, 114, 164)"># The topic to which all functions logs are published</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For instructions on running functions in your Pulsar cluster, see the <a href="/docs/2.4.0/functions-deploying">Deploying Pulsar Functions</a> guide.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="available-apis">Available APIs<a aria-hidden="true" class="hash-link" href="#available-apis" title="Direct link to heading">â€‹</a></h3><p>In both Java and Python, you have two options for writing Pulsar Functions:</p><table><thead><tr><th align="left">Interface</th><th align="left">Description</th><th align="left">Use cases</th></tr></thead><tbody><tr><td align="left">Language-native interface</td><td align="left">No Pulsar-specific libraries or special dependencies required (only core libraries from Java/Python)</td><td align="left">Functions that don&#x27;t require access to the function&#x27;s <a href="#context">context</a></td></tr><tr><td align="left">Pulsar Function SDK for Java/Python</td><td align="left">Pulsar-specific libraries that provide a range of functionality not provided by &quot;native&quot; interfaces</td><td align="left">Functions that require access to the function&#x27;s <a href="#context">context</a></td></tr></tbody></table><p>In Python, for example, this language-native function, which adds an exclamation point to all incoming strings and publishes the resulting string to a topic, would have no external dependencies:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{}!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This function, however, would use the Pulsar Functions <a href="#python-sdk-functions">SDK for Python</a>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pulsar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">DisplayFunctionName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        function_name </span><span class="token operator">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">function_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The function processing this message has the name {0}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">function_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="functions-messages-and-message-types">Functions, Messages and Message Types<a aria-hidden="true" class="hash-link" href="#functions-messages-and-message-types" title="Direct link to heading">â€‹</a></h3><p>Pulsar Functions can take byte arrays as inputs and spit out byte arrays as output. However in languages that support typed interfaces(just Java at the moment) one can write typed Functions as well. In this scenario, there are two ways one can bind messages to types.</p><ul><li><a href="#Schema-Registry">Schema Registry</a></li><li><a href="#SerDe">SerDe</a></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="schema-registry">Schema Registry<a aria-hidden="true" class="hash-link" href="#schema-registry" title="Direct link to heading">â€‹</a></h3><p>Pulsar has a built in <a href="/docs/2.4.0/concepts-schema-registry">Schema Registry</a> and comes bundled with a variety of popular schema types(avro, json and protobuf). Pulsar Functions can leverage existing schema information from input topics to derive the input type. The same applies for output topic as well.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="serde">SerDe<a aria-hidden="true" class="hash-link" href="#serde" title="Direct link to heading">â€‹</a></h3><p>SerDe stands for <strong>Ser</strong>ialization and <strong>De</strong>serialization. All Pulsar Functions use SerDe for message handling. How SerDe works by default depends on the language you&#x27;re using for a particular function:</p><ul><li>In <a href="#python-serde">Python</a>, the default SerDe is identity, meaning that the type is serialized as whatever type the producer function returns</li><li>In <a href="#java-serde">Java</a>, a number of commonly used types (<code>String</code>s, <code>Integer</code>s, etc.) are supported by default</li></ul><p>In both languages, however, you can write your own custom SerDe logic for more complex, application-specific types. See the docs for <a href="#java-serde">Java</a> and <a href="#python-serde">Python</a> for language-specific instructions.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="context">Context<a aria-hidden="true" class="hash-link" href="#context" title="Direct link to heading">â€‹</a></h3><p>Both the <a href="#java-sdk-functions">Java</a> and <a href="#python-sdk-functions">Python</a> SDKs provide access to a <strong>context object</strong> that can be used by the function. This context object provides a wide variety of information and functionality to the function:</p><ul><li>The name and ID of the Pulsar Function</li><li>The message ID of each message. Each Pulsar message is automatically assigned an ID.</li><li>The key, event time, properties and partition key of each message</li><li>The name of the topic on which the message was sent</li><li>The names of all input topics as well as the output topic associated with the function</li><li>The name of the class used for <a href="#serialization-and-deserialization-serde">SerDe</a></li><li>The <a href="/docs/2.4.0/reference-terminology#tenant">tenant</a> and namespace associated with the function</li><li>The ID of the Pulsar Functions instance running the function</li><li>The version of the function</li><li>The <a href="/docs/2.4.0/functions-overview#logging">logger object</a> used by the function, which can be used to create function log messages</li><li>Access to arbitrary <a href="#user-config">user config</a> values supplied via the CLI</li><li>An interface for recording <a href="/docs/2.4.0/functions-metrics">metrics</a></li><li>An interface for storing and retrieving state in <a href="/docs/2.4.0/functions-overview#state-storage">state storage</a></li><li>A function to publish new messages onto arbitrary topics.</li><li>A function to acknowledge the message being processed (if auto-acknowledgement is disabled).</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="user-config">User config<a aria-hidden="true" class="hash-link" href="#user-config" title="Direct link to heading">â€‹</a></h3><p>When you run or update Pulsar Functions created using the <a href="#available-apis">SDK</a>, you can pass arbitrary key/values to them via the command line with the <code>--userConfig</code> flag. Key/values must be specified as JSON. Here&#x27;s an example of a function creation command that passes a user config key/value to a function:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions create </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --name word-filter </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Other function configs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --user-config </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{&quot;forbidden-word&quot;:&quot;rosebud&quot;}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If the function were a Python function, that config value could be accessed like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pulsar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">WordFilter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        forbidden_word </span><span class="token operator">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">user_config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;forbidden-word&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Don&#x27;t publish the message if it contains the user-supplied</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># forbidden word</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> forbidden_word </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># Otherwise publish the message</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="functions-for-java">Functions for Java<a aria-hidden="true" class="hash-link" href="#functions-for-java" title="Direct link to heading">â€‹</a></h2><p>Writing Pulsar Functions in Java involves implementing one of two interfaces:</p><ul><li>The <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html" target="_blank" rel="noopener noreferrer"><code>java.util.Function</code></a> interface</li><li>The <a href="https://pulsar.apache.org/api/pulsar-functions/org/apache/pulsar/functions/api/Function" target="_blank" rel="noopener noreferrer">Function</a> interface. This interface works much like the <code>java.util.Function</code> interface, but with the important difference that it provides a <a href="https://pulsar.apache.org/api/pulsar-functions/org/apache/pulsar/functions/api/Context" target="_blank" rel="noopener noreferrer">Context</a> object that you can use in a <a href="#context">variety of ways</a></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="get-started">Get started<a aria-hidden="true" class="hash-link" href="#get-started" title="Direct link to heading">â€‹</a></h3><p>In order to write Pulsar Functions in Java, you&#x27;ll need to install the proper <a href="#dependencies">dependencies</a> and package your function <a href="#packaging">as a JAR</a>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="dependencies">Dependencies<a aria-hidden="true" class="hash-link" href="#dependencies" title="Direct link to heading">â€‹</a></h4><p>How you get started writing Pulsar Functions in Java depends on which API you&#x27;re using:</p><ul><li><p>If you&#x27;re writing a <a href="#java-native-functions">Java native function</a>, you won&#x27;t need any external dependencies.</p></li><li><p>If you&#x27;re writing a <a href="#java-sdk-functions">Java SDK function</a>, you&#x27;ll need to import the <code>pulsar-functions-api</code> library.</p><p>Here&#x27;s an example for a Maven <code>pom.xml</code> configuration file:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.apache.pulsar</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">pulsar-functions-api</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">2.1.1-incubating</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Here&#x27;s an example for a Gradle <code>build.gradle</code> configuration file:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI groovy"><pre tabindex="0" class="prism-code language-groovy codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">compile group: &#x27;org.apache.pulsar&#x27;, name: &#x27;pulsar-functions-api&#x27;, version: &#x27;2.1.1-incubating&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="packaging">Packaging<a aria-hidden="true" class="hash-link" href="#packaging" title="Direct link to heading">â€‹</a></h4><p>Whether you&#x27;re writing Java Pulsar Functions using the <a href="#java-native-functions">native</a> Java <code>java.util.Function</code> interface or using the <a href="#java-sdk-functions">Java SDK</a>, you&#x27;ll need to package your function(s) as a &quot;fat&quot; JAR.</p><blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="starter-repo">Starter repo<a aria-hidden="true" class="hash-link" href="#starter-repo" title="Direct link to heading">â€‹</a></h4><p>If you&#x27;d like to get up and running quickly, you can use <a href="https://github.com/streamlio/pulsar-functions-java-starter" target="_blank" rel="noopener noreferrer">this repo</a>, which contains the necessary Maven configuration to build a fat JAR as well as some example functions.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-native-functions">Java native functions<a aria-hidden="true" class="hash-link" href="#java-native-functions" title="Direct link to heading">â€‹</a></h3><p>If your function doesn&#x27;t require access to its <a href="#context">context</a>, you can create a Pulsar Function by implementing the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/Function.html" target="_blank" rel="noopener noreferrer"><code>java.util.Function</code></a> interface, which has this very simple, single-method signature:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public interface Function&lt;I, O&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    O apply(I input);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Here&#x27;s an example function that takes a string as its input, adds an exclamation point to the end of the string, and then publishes the resulting string:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Function;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class ExclamationFunction implements Function&lt;String, String&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public String process(String input) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return String.format(&quot;%s!&quot;, input);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In general, you should use native functions when you don&#x27;t need access to the function&#x27;s <a href="#context">context</a>. If you <em>do</em> need access to the function&#x27;s context, then we recommend using the <a href="#java-sdk-functions">Pulsar Functions Java SDK</a>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="java-native-examples">Java native examples<a aria-hidden="true" class="hash-link" href="#java-native-examples" title="Direct link to heading">â€‹</a></h4><p>There is one example Java native function in this <a href="https://github.com/apache/pulsar/tree/master//pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples" target="_blank" rel="noopener noreferrer">folder</a>:</p><ul><li><a href="https://github.com/apache/pulsar/tree/master//pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples/JavaNativeExclamationFunction.java" target="_blank" rel="noopener noreferrer">JavaNativeExclamationFunction</a></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-sdk-functions">Java SDK functions<a aria-hidden="true" class="hash-link" href="#java-sdk-functions" title="Direct link to heading">â€‹</a></h3><p>To get started developing Pulsar Functions using the Java SDK, you&#x27;ll need to add a dependency on the <code>pulsar-functions-api</code> artifact to your project. Instructions can be found <a href="#dependencies">above</a>.</p><blockquote><p>An easy way to get up and running with Pulsar Functions in Java is to clone the <a href="https://github.com/streamlio/pulsar-functions-java-starter" target="_blank" rel="noopener noreferrer"><code>pulsar-functions-java-starter</code></a> repo and follow the instructions there.</p></blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="java-sdk-examples">Java SDK examples<a aria-hidden="true" class="hash-link" href="#java-sdk-examples" title="Direct link to heading">â€‹</a></h4><p>There are several example Java SDK functions in this <a href="https://github.com/apache/pulsar/tree/master//pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples" target="_blank" rel="noopener noreferrer">folder</a>:</p><table><thead><tr><th align="left">Function name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples/ContextFunction.java" target="_blank" rel="noopener noreferrer"><code>ContextFunction</code></a></td><td align="left">Illustrates <a href="#context">context</a>-specific functionality like <a href="#java-logging">logging</a> and <a href="#java-metrics">metrics</a></td></tr><tr><td align="left"><a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples/WordCountFunction.java" target="_blank" rel="noopener noreferrer"><code>WordCountFunction</code></a></td><td align="left">Illustrates usage of Pulsar Function <a href="/docs/2.4.0/functions-overview#state-storage">state-storage</a></td></tr><tr><td align="left"><a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples/ExclamationFunction.java" target="_blank" rel="noopener noreferrer"><code>ExclamationFunction</code></a></td><td align="left">A basic string manipulation function for the Java SDK <a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples/LoggingFunction.java" target="_blank" rel="noopener noreferrer"><code>LoggingFunction</code></a></td></tr><tr><td align="left"><a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples/UserConfigFunction.java" target="_blank" rel="noopener noreferrer"><code>UserConfigFunction</code></a></td><td align="left">A function that consumes <a href="#java-user-config">user-supplied configuration</a> values <a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/java-examples/src/main/java/org/apache/pulsar/functions/api/examples/UserMetricFunction.java" target="_blank" rel="noopener noreferrer"><code>UserMetricFunction</code></a></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-context-object">Java context object<a aria-hidden="true" class="hash-link" href="#java-context-object" title="Direct link to heading">â€‹</a></h3><p>The <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/functions/api/Context" target="_blank" rel="noopener noreferrer">Context</a> interface provides a number of methods that you can use to access the function&#x27;s <a href="#context">context</a>. The various method signatures for the <code>Context</code> interface are listed below:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public interface Context {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Record&lt;?&gt; getCurrentRecord();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Collection&lt;String&gt; getInputTopics();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getOutputTopic();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getOutputSchemaType();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getTenant();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getNamespace();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getFunctionName();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getFunctionId();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getInstanceId();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    String getFunctionVersion();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Logger getLogger();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    void incrCounter(String key, long amount);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    void incrCounterAsync(String key, long amount);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    long getCounter(String key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    long getCounterAsync(String key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    void putState(String key, ByteBuffer value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    void putStateAsync(String key, ByteBuffer value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ByteBuffer getState(String key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ByteBuffer getStateAsync(String key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Map&lt;String, Object&gt; getUserConfigMap();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Optional&lt;Object&gt; getUserConfigValue(String key);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Object getUserConfigValueOrDefault(String key, Object defaultValue);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    void recordMetric(String metricName, double value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;O&gt; CompletableFuture&lt;Void&gt; publish(String topicName, O object, String schemaOrSerdeClassName);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &lt;O&gt; CompletableFuture&lt;Void&gt; publish(String topicName, O object);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Here&#x27;s an example function that uses several methods available via the <code>Context</code> object:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Context;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Function;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.slf4j.Logger;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.stream.Collectors;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class ContextFunction implements Function&lt;String, Void&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public Void process(String input, Context context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Logger LOG = context.getLogger();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String inputTopics = context.getInputTopics().stream().collect(Collectors.joining(&quot;, &quot;));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String functionName = context.getFunctionName();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String logMessage = String.format(&quot;A message with a value of \&quot;%s\&quot; has arrived on one of the following topics: %s\n&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                input,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                inputTopics);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        LOG.info(logMessage);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String metricName = String.format(&quot;function-%s-messages-received&quot;, functionName);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        context.recordMetric(metricName, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="void-functions">Void functions<a aria-hidden="true" class="hash-link" href="#void-functions" title="Direct link to heading">â€‹</a></h3><p>Pulsar Functions can publish results to an output topic, but this isn&#x27;t required. You can also have functions that simply produce a log, write results to a database, etc. Here&#x27;s a function that writes a simple log every time a message is received:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.slf4j.Logger;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class LogFunction implements PulsarFunction&lt;String, Void&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public String apply(String input, Context context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Logger LOG = context.getLogger();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        LOG.info(&quot;The following message was received: {}&quot;, input);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><p>When using Java functions in which the output type is <code>Void</code>, the function must <em>always</em> return <code>null</code>.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-serde">Java SerDe<a aria-hidden="true" class="hash-link" href="#java-serde" title="Direct link to heading">â€‹</a></h3><p>Pulsar Functions use <a href="#serialization-and-deserialization-serde">SerDe</a> when publishing data to and consuming data from Pulsar topics. When you&#x27;re writing Pulsar Functions in Java, the following basic Java types are built in and supported by default:</p><ul><li><code>String</code></li><li><code>Double</code></li><li><code>Integer</code></li><li><code>Float</code></li><li><code>Long</code></li><li><code>Short</code></li><li><code>Byte</code></li></ul><p>Built-in vs. custom. For custom, you need to implement this interface:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public interface SerDe&lt;T&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    T deserialize(byte[] input);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    byte[] serialize(T input);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="java-serde-example">Java SerDe example<a aria-hidden="true" class="hash-link" href="#java-serde-example" title="Direct link to heading">â€‹</a></h4><p>Imagine that you&#x27;re writing Pulsar Functions in Java that are processing tweet objects. Here&#x27;s a simple example <code>Tweet</code> class:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class Tweet {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String username;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private String tweetContent;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public Tweet(String username, String tweetContent) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.username = username;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.tweetContent = tweetContent;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Standard setters and getters</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In order to be able to pass <code>Tweet</code> objects directly between Pulsar Functions, you&#x27;ll need to provide a custom SerDe class. In the example below, <code>Tweet</code> objects are basically strings in which the username and tweet content are separated by a <code>|</code>.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">package com.example.serde;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.SerDe;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.regex.Pattern;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class TweetSerde implements SerDe&lt;Tweet&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public Tweet deserialize(byte[] input) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String s = new String(input);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String[] fields = s.split(Pattern.quote(&quot;|&quot;));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return new Tweet(fields[0], fields[1]);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public byte[] serialize(Tweet input) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return &quot;%s|%s&quot;.format(input.getUsername(), input.getTweetContent()).getBytes();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To apply this custom SerDe to a particular Pulsar Function, you would need to:</p><ul><li>Package the <code>Tweet</code> and <code>TweetSerde</code> classes into a JAR</li><li>Specify a path to the JAR and SerDe class name when deploying the function</li></ul><p>Here&#x27;s an example <a href="/docs/2.4.0/pulsar-admin#create-1"><code>create</code></a> operation:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions create </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --jar /path/to/your.jar </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --output-serde-classname com.example.serde.TweetSerde </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Other function attributes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="custom-serde-classes-must-be-packaged-with-your-function-jars">Custom SerDe classes must be packaged with your function JARs<a aria-hidden="true" class="hash-link" href="#custom-serde-classes-must-be-packaged-with-your-function-jars" title="Direct link to heading">â€‹</a></h4><p>Pulsar does not store your custom SerDe classes separately from your Pulsar Functions. That means that you&#x27;ll need to always include your SerDe classes in your function JARs. If not, Pulsar will return an error.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-logging">Java logging<a aria-hidden="true" class="hash-link" href="#java-logging" title="Direct link to heading">â€‹</a></h3><p>Pulsar Functions that use the <a href="#java-sdk-functions">Java SDK</a> have access to an <a href="https://www.slf4j.org/" target="_blank" rel="noopener noreferrer">SLF4j</a> <a href="https://www.slf4j.org/api/org/apache/log4j/Logger.html" target="_blank" rel="noopener noreferrer"><code>Logger</code></a> object that can be used to produce logs at the chosen log level. Here&#x27;s a simple example function that logs either a <code>WARNING</code>- or <code>INFO</code>-level log based on whether the incoming string contains the word <code>danger</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Context;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Function;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.slf4j.Logger;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class LoggingFunction implements Function&lt;String, Void&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void apply(String input, Context context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Logger LOG = context.getLogger();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        String messageId = new String(context.getMessageId());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (input.contains(&quot;danger&quot;)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            LOG.warn(&quot;A warning was received in message {}&quot;, messageId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            LOG.info(&quot;Message {} received\nContent: {}&quot;, messageId, input);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you want your function to produce logs, you need to specify a log topic when creating or running the function. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions create </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --jar my-functions.jar </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --classname my.package.LoggingFunction </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --log-topic persistent://public/default/logging-function-logs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Other function configs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Now, all logs produced by the <code>LoggingFunction</code> above can be accessed via the <code>persistent://public/default/logging-function-logs</code> topic.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-user-config">Java user config<a aria-hidden="true" class="hash-link" href="#java-user-config" title="Direct link to heading">â€‹</a></h3><p>The Java SDK&#x27;s <a href="#context"><code>Context</code></a> object enables you to access key/value pairs provided to the Pulsar Function via the command line (as JSON). Here&#x27;s an example function creation command that passes a key/value pair:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions create </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Other function configs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --user-config </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{&quot;word-of-the-day&quot;:&quot;verdure&quot;}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To access that value in a Java function:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Context;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Function;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.slf4j.Logger;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Optional;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class UserConfigFunction implements Function&lt;String, Void&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void apply(String input, Context context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Logger LOG = context.getLogger();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Optional&lt;String&gt; wotd = context.getUserConfigValue(&quot;word-of-the-day&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (wotd.isPresent()) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            LOG.info(&quot;The word of the day is {}&quot;, wotd);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            LOG.warn(&quot;No word of the day provided&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>UserConfigFunction</code> function will log the string <code>&quot;The word of the day is verdure&quot;</code> every time the function is invoked (i.e. every time a message arrives). The <code>word-of-the-day</code> user config will be changed only when the function is updated with a new config value via the command line.</p><p>You can also access the entire user config map or set a default value in case no value is present:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Get the whole config map</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Map&lt;String, String&gt; allConfigs = context.getUserConfigMap();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Get value or resort to default</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">String wotd = context.getUserConfigValueOrDefault(&quot;word-of-the-day&quot;, &quot;perspicacious&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><p>For all key/value pairs passed to Java Pulsar Functions, both the key <em>and</em> the value are <code>String</code>s. If you&#x27;d like the value to be of a different type, you will need to deserialize from the <code>String</code> type.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="java-metrics">Java metrics<a aria-hidden="true" class="hash-link" href="#java-metrics" title="Direct link to heading">â€‹</a></h3><p>You can record metrics using the <a href="#context"><code>Context</code></a> object on a per-key basis. You can, for example, set a metric for the key <code>process-count</code> and a different metric for the key <code>elevens-count</code> every time the function processes a message. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Context;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.functions.api.Function;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class MetricRecorderFunction implements Function&lt;Integer, Void&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void apply(Integer input, Context context) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // Records the metric 1 every time a message arrives</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        context.recordMetric(&quot;hit-count&quot;, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // Records the metric only if the arriving number equals 11</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (input == 11) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            context.recordMetric(&quot;elevens-count&quot;, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return null;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><p>For instructions on reading and using metrics, see the <a href="/docs/2.4.0/deploy-monitoring">Monitoring</a> guide.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="functions-for-python">Functions for Python<a aria-hidden="true" class="hash-link" href="#functions-for-python" title="Direct link to heading">â€‹</a></h2><p>Writing Pulsar Functions in Python entails implementing one of two things:</p><ul><li>A <code>process</code> function that takes an input (message data from the function&#x27;s input topic(s)), applies some kind of logic to it, and either returns an object (to be published to the function&#x27;s output topic) or <code>pass</code>es and thus doesn&#x27;t produce a message</li><li>A <code>Function</code> class that has a <code>process</code> method that provides a message input to process and a <a href="#context">context</a> object</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="get-started-1">Get started<a aria-hidden="true" class="hash-link" href="#get-started-1" title="Direct link to heading">â€‹</a></h3><p>Regardless of which <a href="/docs/2.4.0/functions-deploying">deployment mode</a> you&#x27;re using, &#x27;pulsar-client&#x27; python library has to installed on any machine that&#x27;s running Pulsar Functions written in Python.</p><p>That could be your local machine for <a href="/docs/2.4.0/functions-deploying#local-run-mode">local run mode</a> or a machine running a Pulsar <a href="/docs/2.4.0/reference-terminology#broker">broker</a> for <a href="/docs/2.4.0/functions-deploying#cluster-mode">cluster mode</a>. To install those libraries using pip:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ pip </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> pulsar-client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="packaging-1">Packaging<a aria-hidden="true" class="hash-link" href="#packaging-1" title="Direct link to heading">â€‹</a></h3><p>At the moment, the code for Pulsar Functions written in Python must be contained within a single Python file. In the future, Pulsar Functions may support other packaging formats, such as <a href="https://github.com/pantsbuild/pex" target="_blank" rel="noopener noreferrer"><strong>P</strong>ython <strong>EX</strong>ecutables</a> (PEXes).</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="python-native-functions">Python native functions<a aria-hidden="true" class="hash-link" href="#python-native-functions" title="Direct link to heading">â€‹</a></h3><p>If your function doesn&#x27;t require access to its <a href="#context">context</a>, you can create a Pulsar Function by implementing a <code>process</code> function, which provides a single input object that you can process however you wish. Here&#x27;s an example function that takes a string as its input, adds an exclamation point at the end of the string, and then publishes the resulting string:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{0}!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In general, you should use native functions when you don&#x27;t need access to the function&#x27;s <a href="#context">context</a>. If you <em>do</em> need access to the function&#x27;s context, then we recommend using the <a href="#python-sdk-functions">Pulsar Functions Python SDK</a>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="python-native-examples">Python native examples<a aria-hidden="true" class="hash-link" href="#python-native-examples" title="Direct link to heading">â€‹</a></h4><p>There is one example Python native function in this <a href="https://github.com/apache/pulsar/tree/master//pulsar-functions/python-examples" target="_blank" rel="noopener noreferrer">folder</a>:</p><ul><li>{@inject: github:<code>native_exclamation_function.py</code>:/pulsar-functions/python-examples/native_exclamation_function.py}</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="python-sdk-functions">Python SDK functions<a aria-hidden="true" class="hash-link" href="#python-sdk-functions" title="Direct link to heading">â€‹</a></h3><p>To get started developing Pulsar Functions using the Python SDK, you&#x27;ll need to install the <a href="/api/python/2.4.0"><code>pulsar-client</code></a> library using the instructions <a href="#getting-started">above</a>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="python-sdk-examples">Python SDK examples<a aria-hidden="true" class="hash-link" href="#python-sdk-examples" title="Direct link to heading">â€‹</a></h4><p>There are several example Python functions in this <a href="https://github.com/apache/pulsar/tree/master//pulsar-functions/python-examples" target="_blank" rel="noopener noreferrer">folder</a>:</p><table><thead><tr><th align="left">Function file</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/python-examples/exclamation_function.py" target="_blank" rel="noopener noreferrer"><code>exclamation_function.py</code></a></td><td align="left">Adds an exclamation point at the end of each incoming string <a href="https://github.com/apache/pulsar/blob/master/pulsar-functions/python-examples/logging_function.py" target="_blank" rel="noopener noreferrer"><code>logging_function.py</code></a></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="python-context-object">Python context object<a aria-hidden="true" class="hash-link" href="#python-context-object" title="Direct link to heading">â€‹</a></h4><p>The <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/python/pulsar/functions/context.py" target="_blank" rel="noopener noreferrer"><code>Context</code></a> class provides a number of methods that you can use to access the function&#x27;s <a href="#context">context</a>. The various methods for the <code>Context</code> class are listed below:</p><table><thead><tr><th align="left">Method</th><th align="left">What it provides</th></tr></thead><tbody><tr><td align="left"><code>get_message_id</code></td><td align="left">The message ID of the message being processed</td></tr><tr><td align="left"><code>get_message_key</code></td><td align="left">The key of the message being processed</td></tr><tr><td align="left"><code>get_message_eventtime</code></td><td align="left">The event time of the message being processed</td></tr><tr><td align="left"><code>get_message_properties</code></td><td align="left">The properties of the message being processed</td></tr><tr><td align="left"><code>get_current_message_topic_name</code></td><td align="left">The topic of the message being currently being processed</td></tr><tr><td align="left"><code>get_function_tenant</code></td><td align="left">The tenant under which the current Pulsar Function runs under</td></tr><tr><td align="left"><code>get_function_namespace</code></td><td align="left">The namespace under which the current Pulsar Function runs under</td></tr><tr><td align="left"><code>get_function_name</code></td><td align="left">The name of the current Pulsar Function</td></tr><tr><td align="left"><code>get_function_id</code></td><td align="left">The ID of the current Pulsar Function</td></tr><tr><td align="left"><code>get_instance_id</code></td><td align="left">The ID of the current Pulsar Functions instance</td></tr><tr><td align="left"><code>get_function_version</code></td><td align="left">The version of the current Pulsar Function</td></tr><tr><td align="left"><code>get_logger</code></td><td align="left">A logger object that can be used for <a href="#python-logging">logging</a></td></tr><tr><td align="left"><code>get_user_config_value</code></td><td align="left">Returns the value of a <a href="#python-user-config">user-defined config</a> (or <code>None</code> if the config doesn&#x27;t exist)</td></tr><tr><td align="left"><code>get_user_config_map</code></td><td align="left">Returns the entire user-defined config as a dict</td></tr><tr><td align="left"><code>get_secret</code></td><td align="left">The secret value associated with the name</td></tr><tr><td align="left"><code>get_partition_key</code></td><td align="left">The partition key of the input message</td></tr><tr><td align="left"><code>record_metric</code></td><td align="left">Records a per-key <a href="#python-metrics">metric</a></td></tr><tr><td align="left"><code>publish</code></td><td align="left">Publishes a message to the specified Pulsar topic</td></tr><tr><td align="left"><code>get_output_serde_class_name</code></td><td align="left">The name of the output <a href="#python-serde">SerDe</a> class</td></tr><tr><td align="left"><code>ack</code></td><td align="left"><a href="/docs/2.4.0/reference-terminology#acknowledgment-ack">Acks</a> the message being processed to Pulsar</td></tr><tr><td align="left"><code>incr_counter</code></td><td align="left">Increase the counter of a given key in the managed state</td></tr><tr><td align="left"><code>get_counter</code></td><td align="left">Get the counter of a given key in the managed state</td></tr><tr><td align="left"><code>del_counter</code></td><td align="left">Delete the counter of a given key in the managed state</td></tr><tr><td align="left"><code>put_state</code></td><td align="left">Update the value of a given key in the managed state</td></tr><tr><td align="left"><code>get_state</code></td><td align="left">Get the value of a given key in the managed state</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="python-serde">Python SerDe<a aria-hidden="true" class="hash-link" href="#python-serde" title="Direct link to heading">â€‹</a></h3><p>Pulsar Functions use <a href="#serialization-and-deserialization-serde">SerDe</a> when publishing data to and consuming data from Pulsar topics (this is true of both <a href="#python-native-functions">native</a> functions and <a href="#python-sdk-functions">SDK</a> functions). You can specify the SerDe when <a href="/docs/2.4.0/functions-deploying#cluster-mode">creating</a> or <a href="/docs/2.4.0/functions-deploying#local-run-mode">running</a> functions. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions create </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --tenant public </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --namespace default </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --name my_function </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --py my_function.py </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --classname my_function.MyFunction </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --custom-serde-inputs </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{&quot;input-topic-1&quot;:&quot;Serde1&quot;,&quot;input-topic-2&quot;:&quot;Serde2&quot;}&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --output-serde-classname Serde3 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --output output-topic-1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In this case, there are two input topics, <code>input-topic-1</code> and <code>input-topic-2</code>, each of which is mapped to a different SerDe class (the map must be specified as a JSON string). The output topic, <code>output-topic-1</code>, uses the <code>Serde3</code> class for SerDe. At the moment, all Pulsar Function logic, include processing function and SerDe classes, must be contained within a single Python file.</p><p>When using Pulsar Functions for Python, you essentially have three SerDe options:</p><ol><li>You can use the <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/python/pulsar/functions/serde.py#L70" target="_blank" rel="noopener noreferrer"><code>IdentitySerde</code></a>, which leaves the data unchanged. The <code>IdentitySerDe</code> is the <strong>default</strong>. Creating or running a function without explicitly specifying SerDe will mean that this option is used.</li><li>You can use the <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/python/pulsar/functions/serde.py#L62" target="_blank" rel="noopener noreferrer"><code>PickeSerDe</code></a>, which uses Python&#x27;s <a href="https://docs.python.org/3/library/pickle.html" target="_blank" rel="noopener noreferrer"><code>pickle</code></a> for SerDe.</li><li>You can create a custom SerDe class by implementing the baseline <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/python/pulsar/functions/serde.py#L50" target="_blank" rel="noopener noreferrer"><code>SerDe</code></a> class, which has just two methods: <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/python/pulsar/functions/serde.py#L53" target="_blank" rel="noopener noreferrer"><code>serialize</code></a> for converting the object into bytes, and <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/python/pulsar/functions/serde.py#L58" target="_blank" rel="noopener noreferrer"><code>deserialize</code></a> for converting bytes into an object of the required application-specific type.</li></ol><p>The table below shows when you should use each SerDe:</p><table><thead><tr><th align="left">SerDe option</th><th align="left">When to use</th></tr></thead><tbody><tr><td align="left"><code>IdentitySerde</code></td><td align="left">When you&#x27;re working with simple types like strings, Booleans, integers, and the like</td></tr><tr><td align="left"><code>PickleSerDe</code></td><td align="left">When you&#x27;re working with complex, application-specific types and are comfortable with <code>pickle</code>&#x27;s &quot;best effort&quot; approach</td></tr><tr><td align="left">Custom SerDe</td><td align="left">When you require explicit control over SerDe, potentially for performance or data compatibility purposes</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_y2LR" id="python-serde-example">Python SerDe example<a aria-hidden="true" class="hash-link" href="#python-serde-example" title="Direct link to heading">â€‹</a></h4><p>Imagine that you&#x27;re writing Pulsar Functions in Python that are processing tweet objects. Here&#x27;s a simple <code>Tweet</code> class:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Tweet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">object</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">__init__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tweet_content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">username </span><span class="token operator">=</span><span class="token plain"> username</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tweet_content </span><span class="token operator">=</span><span class="token plain"> tweet_content</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In order to use this class in Pulsar Functions, you&#x27;d have two options:</p><ol><li><p>You could specify <code>PickleSerDe</code>, which would apply the <a href="https://docs.python.org/3/library/pickle.html" target="_blank" rel="noopener noreferrer"><code>pickle</code></a> library&#x27;s SerDe</p></li><li><p>You could create your own SerDe class. Here&#x27;s a simple example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pulsar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> SerDe</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">TweetSerDe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">SerDe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">__init__</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tweet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tweet </span><span class="token operator">=</span><span class="token plain"> tweet</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">serialize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{0}|{1}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tweet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">username</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tweet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tweet_content</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">deserialize</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> input_bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       tweet_components </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">input_bytes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;|&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> Tweet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">tweet_components</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tweet_componentsp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="python-logging">Python logging<a aria-hidden="true" class="hash-link" href="#python-logging" title="Direct link to heading">â€‹</a></h3><p>Pulsar Functions that use the <a href="#python-sdk-functions">Python SDK</a> have access to a logging object that can be used to produce logs at the chosen log level. Here&#x27;s a simple example function that logs either a <code>WARNING</code>- or <code>INFO</code>-level log based on whether the incoming string contains the word <code>danger</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pulsar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">LoggingFunction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        logger </span><span class="token operator">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        msg_id </span><span class="token operator">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_message_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;danger&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;A warning was received in message {0}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_message_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Message {0} received\nContent: {1}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">msg_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you want your function to produce logs on a Pulsar topic, you need to specify a <strong>log topic</strong> when creating or running the function. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions create </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --py logging_function.py </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --classname logging_function.LoggingFunction </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --log-topic logging-function-logs </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Other function configs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Now, all logs produced by the <code>LoggingFunction</code> above can be accessed via the <code>logging-function-logs</code> topic.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="python-user-config">Python user config<a aria-hidden="true" class="hash-link" href="#python-user-config" title="Direct link to heading">â€‹</a></h3><p>The Python SDK&#x27;s <a href="#context"><code>Context</code></a> object enables you to access key/value pairs provided to the Pulsar Function via the command line (as JSON). Here&#x27;s an example function creation command that passes a key/value pair:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ bin/pulsar-admin functions create </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Other function configs \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --user-config </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;{&quot;word-of-the-day&quot;:&quot;verdure&quot;}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To access that value in a Python function:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pulsar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">UserConfigFunction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        logger </span><span class="token operator">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        wotd </span><span class="token operator">=</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_user_config_value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;word-of-the-day&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> wotd </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">warn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;No word of the day provided&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;The word of the day is {0}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">format</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">wotd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="python-metrics">Python metrics<a aria-hidden="true" class="hash-link" href="#python-metrics" title="Direct link to heading">â€‹</a></h3><p>You can record metrics using the <a href="#context"><code>Context</code></a> object on a per-key basis. You can, for example, set a metric for the key <code>process-count</code> and a different metric for the key <code>elevens-count</code> every time the function processes a message. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pulsar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">MetricRecorderFunction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">process</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">record_metric</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;hit-count&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">input</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">11</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            context</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">record_metric</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;elevens-count&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.4.0/functions-api.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/2.4.0/functions-quickstart"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Get started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/2.4.0/functions-deploying"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploying functions<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#core-programming-model" class="table-of-contents__link toc-highlight">Core programming model</a><ul><li><a href="#example-function" class="table-of-contents__link toc-highlight">Example function</a></li><li><a href="#example-deployment" class="table-of-contents__link toc-highlight">Example deployment</a></li><li><a href="#available-apis" class="table-of-contents__link toc-highlight">Available APIs</a></li><li><a href="#functions-messages-and-message-types" class="table-of-contents__link toc-highlight">Functions, Messages and Message Types</a></li><li><a href="#schema-registry" class="table-of-contents__link toc-highlight">Schema Registry</a></li><li><a href="#serde" class="table-of-contents__link toc-highlight">SerDe</a></li><li><a href="#context" class="table-of-contents__link toc-highlight">Context</a></li><li><a href="#user-config" class="table-of-contents__link toc-highlight">User config</a></li></ul></li><li><a href="#functions-for-java" class="table-of-contents__link toc-highlight">Functions for Java</a><ul><li><a href="#get-started" class="table-of-contents__link toc-highlight">Get started</a></li><li><a href="#java-native-functions" class="table-of-contents__link toc-highlight">Java native functions</a></li><li><a href="#java-sdk-functions" class="table-of-contents__link toc-highlight">Java SDK functions</a></li><li><a href="#java-context-object" class="table-of-contents__link toc-highlight">Java context object</a></li><li><a href="#void-functions" class="table-of-contents__link toc-highlight">Void functions</a></li><li><a href="#java-serde" class="table-of-contents__link toc-highlight">Java SerDe</a></li><li><a href="#java-logging" class="table-of-contents__link toc-highlight">Java logging</a></li><li><a href="#java-user-config" class="table-of-contents__link toc-highlight">Java user config</a></li><li><a href="#java-metrics" class="table-of-contents__link toc-highlight">Java metrics</a></li></ul></li><li><a href="#functions-for-python" class="table-of-contents__link toc-highlight">Functions for Python</a><ul><li><a href="#get-started-1" class="table-of-contents__link toc-highlight">Get started</a></li><li><a href="#packaging-1" class="table-of-contents__link toc-highlight">Packaging</a></li><li><a href="#python-native-functions" class="table-of-contents__link toc-highlight">Python native functions</a></li><li><a href="#python-sdk-functions" class="table-of-contents__link toc-highlight">Python SDK functions</a></li><li><a href="#python-serde" class="table-of-contents__link toc-highlight">Python SerDe</a></li><li><a href="#python-logging" class="table-of-contents__link toc-highlight">Python logging</a></li><li><a href="#python-user-config" class="table-of-contents__link toc-highlight">Python user config</a></li><li><a href="#python-metrics" class="table-of-contents__link toc-highlight">Python metrics</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright Â© 2021 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f92a773e.js"></script>
<script src="/assets/js/main.343abb0d.js"></script>
</body>
</html>