<!doctype html>
<html class="docs-version-2.5.0" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed"><title data-react-helmet="true">Schema Registry | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/docs/2.5.0/concepts-schema-registry"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.5.0"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.5.0"><meta data-react-helmet="true" property="og:title" content="Schema Registry | Apache Pulsar"><meta data-react-helmet="true" name="description" content="Type safety is extremely important in any application built around a message bus like Pulsar. Producers and consumers need some kind of mechanism for coordinating types at the topic level lest a wide variety of potential problems arise (for example serialization and deserialization issues). Applications typically adopt one of two basic approaches to type safety in messaging:"><meta data-react-helmet="true" property="og:description" content="Type safety is extremely important in any application built around a message bus like Pulsar. Producers and consumers need some kind of mechanism for coordinating types at the topic level lest a wide variety of potential problems arise (for example serialization and deserialization issues). Applications typically adopt one of two basic approaches to type safety in messaging:"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/docs/2.5.0/concepts-schema-registry"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.5.0/concepts-schema-registry" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.5.0/concepts-schema-registry" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f75c5a00.css">
<link rel="preload" href="/assets/js/runtime~main.f92a773e.js" as="script">
<link rel="preload" href="/assets/js/main.343abb0d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link" href="/docs/2.5.0/">Docs</a><a class="navbar__item navbar__link" href="/versions">Versions</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/docs">Version</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/">2.8.0</a></li><li><a class="dropdown__link" href="/docs/2.7.3/">2.7.3</a></li><li><a class="dropdown__link" href="/docs/2.7.2/">2.7.2</a></li><li><a class="dropdown__link" href="/docs/2.7.1/">2.7.1</a></li><li><a class="dropdown__link" href="/docs/2.7.0/">2.7.0</a></li><li><a class="dropdown__link" href="/docs/2.6.4/">2.6.4</a></li><li><a class="dropdown__link" href="/docs/2.6.3/">2.6.3</a></li><li><a class="dropdown__link" href="/docs/2.6.2/">2.6.2</a></li><li><a class="dropdown__link" href="/docs/2.6.1/">2.6.1</a></li><li><a class="dropdown__link" href="/docs/2.6.0/">2.6.0</a></li><li><a class="dropdown__link" href="/docs/2.5.2/">2.5.2</a></li><li><a class="dropdown__link" href="/docs/2.5.1/">2.5.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/2.5.0/">2.5.0</a></li><li><a class="dropdown__link" href="/docs/2.4.2/">2.4.2</a></li><li><a class="dropdown__link" href="/docs/2.4.1/">2.4.1</a></li><li><a class="dropdown__link" href="/docs/2.4.0/">2.4.0</a></li><li><a class="dropdown__link" href="/docs/2.2.0/">2.2.0</a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><main class="docMainContainer_r8cw docMainContainerEnhanced_SOUu"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Pulsar<!-- --> <b>2.5.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/">latest version</a></b> (<!-- -->2.8.0<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2.5.0</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Schema Registry</h1></header><p>Type safety is extremely important in any application built around a message bus like Pulsar. Producers and consumers need some kind of mechanism for coordinating types at the topic level lest a wide variety of potential problems arise (for example serialization and deserialization issues). Applications typically adopt one of two basic approaches to type safety in messaging:</p><ol><li>A &quot;client-side&quot; approach in which message producers and consumers are responsible for not only serializing and deserializing messages (which consist of raw bytes) but also &quot;knowing&quot; which types are being transmitted via which topics. If a producer is sending temperature sensor data on the topic <code>topic-1</code>, consumers of that topic will run into trouble if they attempt to parse that data as, say, moisture sensor readings.</li><li>A &quot;server-side&quot; approach in which producers and consumers inform the system which data types can be transmitted via the topic. With this approach, the messaging system enforces type safety and ensures that producers and consumers remain synced.</li></ol><p>Both approaches are available in Pulsar, and you&#x27;re free to adopt one or the other or to mix and match on a per-topic basis.</p><ol><li>For the &quot;client-side&quot; approach, producers and consumers can send and receive messages consisting of raw byte arrays and leave all type safety enforcement to the application on an &quot;out-of-band&quot; basis.</li><li>For the &quot;server-side&quot; approach, Pulsar has a built-in <strong>schema registry</strong> that enables clients to upload data schemas on a per-topic basis. Those schemas dictate which data types are recognized as valid for that topic.</li></ol><h4 class="anchor anchorWithStickyNavbar_y2LR" id="note">Note<a aria-hidden="true" class="hash-link" href="#note" title="Direct link to heading">â€‹</a></h4><blockquote><p>Currently, the Pulsar schema registry is only available for the <a href="/docs/2.5.0/client-libraries-java">Java client</a>, <a href="/docs/2.5.0/client-libraries-go">CGo client</a>, <a href="/docs/2.5.0/client-libraries-python">Python client</a>, and <a href="/docs/2.5.0/client-libraries-cpp">C++ client</a>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="basic-architecture">Basic architecture<a aria-hidden="true" class="hash-link" href="#basic-architecture" title="Direct link to heading">â€‹</a></h2><p>Schemas are automatically uploaded when you create a typed Producer with a Schema. Additionally, Schemas can be manually uploaded to, fetched from, and updated via Pulsar&#x27;s <a href="https://pulsar.apache.org/admin-rest-api#tag/schemas" target="_blank" rel="noopener noreferrer">REST</a> API.</p><blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="other-schema-registry-backends">Other schema registry backends<a aria-hidden="true" class="hash-link" href="#other-schema-registry-backends" title="Direct link to heading">â€‹</a></h4><p>Out of the box, Pulsar uses the <a href="/docs/2.5.0/concepts-architecture-overview#persistent-storage">Apache BookKeeper</a> log storage system for schema storage. You can, however, use different backends if you wish. Documentation for custom schema storage logic is coming soon.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-schemas-work">How schemas work<a aria-hidden="true" class="hash-link" href="#how-schemas-work" title="Direct link to heading">â€‹</a></h2><p>Pulsar schemas are applied and enforced <em>at the topic level</em> (schemas cannot be applied at the namespace or tenant level). Producers and consumers upload schemas to Pulsar brokers.</p><p>Pulsar schemas are fairly simple data structures that consist of:</p><ul><li>A <strong>name</strong>. In Pulsar, a schema&#x27;s name is the topic to which the schema is applied.</li><li>A <strong>payload</strong>, which is a binary representation of the schema</li><li>A schema <a href="#supported-schema-formats"><strong>type</strong></a></li><li>User-defined <strong>properties</strong> as a string/string map. Usage of properties is wholly application specific. Possible properties might be the Git hash associated with a schema, an environment like <code>dev</code> or <code>prod</code>, etc.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="schema-versions">Schema versions<a aria-hidden="true" class="hash-link" href="#schema-versions" title="Direct link to heading">â€‹</a></h2><p>In order to illustrate how schema versioning works, let&#x27;s walk through an example. Imagine that the Pulsar <a href="/docs/2.5.0/client-libraries-java">Java client</a> created using the code below attempts to connect to Pulsar and begin sending messages:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PulsarClient client = PulsarClient.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .serviceUrl(&quot;pulsar://localhost:6650&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;SensorReading&gt; producer = client.newProducer(JSONSchema.of(SensorReading.class))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(&quot;sensor-data&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .sendTimeout(3, TimeUnit.SECONDS)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The table below lists the possible scenarios when this connection attempt occurs and what will happen in light of each scenario:</p><table><thead><tr><th align="left">Scenario</th><th align="left">What happens</th></tr></thead><tbody><tr><td align="left">No schema exists for the topic</td><td align="left">The producer is created using the given schema. The schema is transmitted to the broker and stored (since no existing schema is &quot;compatible&quot; with the <code>SensorReading</code> schema). Any consumer created using the same schema/topic can consume messages from the <code>sensor-data</code> topic.</td></tr><tr><td align="left">A schema already exists; the producer connects using the same schema that&#x27;s already stored</td><td align="left">The schema is transmitted to the Pulsar broker. The broker determines that the schema is compatible. The broker attempts to store the schema in <a href="/docs/2.5.0/concepts-architecture-overview#persistent-storage">BookKeeper</a> but then determines that it&#x27;s already stored, so it&#x27;s then used to tag produced messages.</td></tr><tr><td align="left">A schema already exists; the producer connects using a new schema that is compatible</td><td align="left">The producer transmits the schema to the broker. The broker determines that the schema is compatible and stores the new schema as the current version (with a new version number).</td></tr></tbody></table><blockquote><p>Schemas are versioned in succession. Schema storage happens in the broker that handles the associated topic so that version assignments can be made. Once a version is assigned/fetched to/for a schema, all subsequent messages produced by that producer are tagged with the appropriate version.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="supported-schema-formats">Supported schema formats<a aria-hidden="true" class="hash-link" href="#supported-schema-formats" title="Direct link to heading">â€‹</a></h2><p>The following formats are supported by the Pulsar schema registry:</p><ul><li>None. If no schema is specified for a topic, producers and consumers will handle raw bytes.</li><li><code>String</code> (used for UTF-8-encoded strings)</li><li><a href="https://www.json.org/" target="_blank" rel="noopener noreferrer">JSON</a></li><li><a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">Protobuf</a></li><li><a href="https://avro.apache.org/" target="_blank" rel="noopener noreferrer">Avro</a></li></ul><p>For usage instructions, see the documentation for your preferred client library:</p><ul><li><a href="/docs/2.5.0/client-libraries-java#schemas">Java</a></li></ul><blockquote><p>Support for other schema formats will be added in future releases of Pulsar.</p></blockquote><p>The following example shows how to define an Avro schema using the <code>GenericSchemaBuilder</code>, generate a generic Avro schema using <code>GenericRecordBuilder</code>, and consume messages into <code>GenericRecord</code>.</p><p><strong>Example</strong> </p><ol><li><p>Use the <code>RecordSchemaBuilder</code> to build a schema.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">RecordSchemaBuilder recordSchemaBuilder = SchemaBuilder.record(&quot;schemaName&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">recordSchemaBuilder.field(&quot;intField&quot;).type(SchemaType.INT32);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">SchemaInfo schemaInfo = recordSchemaBuilder.build(SchemaType.AVRO);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;GenericRecord&gt; producer = client.newProducer(Schema.generic(schemaInfo)).create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Use <code>RecordBuilder</code> to build the generic records.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.newMessage().value(schema.newRecordBuilder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            .set(&quot;intField&quot;, 32)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            .build()).send();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="managing-schemas">Managing Schemas<a aria-hidden="true" class="hash-link" href="#managing-schemas" title="Direct link to heading">â€‹</a></h2><p>You can use Pulsar admin tools to manage schemas for topics.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.5.0/concepts-schema-registry.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basic-architecture" class="table-of-contents__link toc-highlight">Basic architecture</a></li><li><a href="#how-schemas-work" class="table-of-contents__link toc-highlight">How schemas work</a></li><li><a href="#schema-versions" class="table-of-contents__link toc-highlight">Schema versions</a></li><li><a href="#supported-schema-formats" class="table-of-contents__link toc-highlight">Supported schema formats</a></li><li><a href="#managing-schemas" class="table-of-contents__link toc-highlight">Managing Schemas</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright Â© 2021 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f92a773e.js"></script>
<script src="/assets/js/main.343abb0d.js"></script>
</body>
</html>